<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Actuators - Donkey Car</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Actuators";
    var mkdocs_page_input_path = "parts/actuators.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-99215530-2', 'github.io/donkey');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Donkey Car</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/build_hardware/">Build a car.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/install_software/">Install the software.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/create_application/">Create Donkeycar App.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/calibrate/">Calibrate steering and throttle.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/get_driving/">Get driving.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/train_autopilot/">Train an autopilot.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/dataset_pretrained_models/">Dataset and pre-trained models</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/simulator/">Donkey Simulator.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/virtual_race_league/">Virtual Race League.</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/mobile_app/">Mobile app</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Parts</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Actuators</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#arduino">Arduino</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calibration">Calibration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#using-the-arduino-actuator-part">Using the arduino actuator part</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../controllers/">Controllers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../keras/">Keras</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../stores/">Stores</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../imu/">IMU</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../oled/">OLED</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../voice_control/">Voice Control</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../stop_sign_detection/">Stop Sign Detection</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Utilities</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../utility/donkey/">donkey</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Developer Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev_guide/model/">Create your own model</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../supported_cars/">Supported Cars</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../roll_your_own/">Roll Your Own</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../contribute/">Contribute</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tests/">Tests</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../release/">Releases</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../legacy/">Legacy</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Donkey Car</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Parts &raquo;</li>
        
      
    
    <li>Actuators</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/autorope/donkeydocs/edit/master/docs/parts/actuators.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="acutators">Acutators</h1>
<blockquote>
<p>Oh noes, nothing in here except Arduino actuator ! This section needs expansion!</p>
</blockquote>
<h2 id="arduino">Arduino</h2>
<p>Arduino can be used in the following fashion to generate PWM signals to control the steering and throttle.</p>
<p>For now the Arduino mode is only tested on the <a href="https://www.lattepanda.com/products/lattepanda-delta-432.html">Latte Panda Delta (LP-D)</a> board.
However it should be straigtforward to use it with Raspberry Pi / Jetson Nano (instead of PCA 9685).</p>
<p>Refer to the below block diagram to understand where things fits in.</p>
<p><img alt="block diagram" src="../../assets/Arduino_actuator_blk_dgm.jpg" /></p>
<p>Arduino board should be running the standard firmata sketch (This sketch comes by default when you download the arduino tool). Load the standard firmata sketch (from <em>Examples &gt; Firmata &gt; StandardFirmata</em>) onto the Arduino.
<img alt="wiring diagram" src="../../assets/Arduino_firmata_sketch.jpg" /> 
Further <strong>pymata_aio_</strong> python package needs to be installed on the car computer via <em>pip3 install pymata_aio</em>.</p>
<p>As shown in the block-diagram above LattePanda combines both the x86 CPU and the Connected Arduino into a single board.</p>
<p>The following diagram shows how to connect the Arduino pins to steering servo and ESC.</p>
<p><img alt="wiring diagram" src="../../assets/ArduinoWiring.png" />
Note that the power for the servo is provided by the ESC battery elemininator circuit (BEC) which most ESC's provide.
This is done to avoid supplying the entire servo power from Arduino's 5v.
In large RC cars the servo can drag up to 2 amps, which lead to a destruction of the Arduino.</p>
<h3 id="calibration">Calibration</h3>
<p>Note that the calibration procedure/values are slightly different for the Arduino (than PCA9685).
Note that 90 is the usual midpoint (i.e. 1.5 ms pulse width at 50 Hz), so it is recommended to start
 with 90 and adjust +/- 5 until you figure the desired range for steering / throttle.</p>
<pre><code class="language-bash">(env1) jithu@jithu-lp:~/master/pred_mt/lp/001/donkey$ donkey calibrate --arduino --channel 6
using donkey v2.6.0t ...

pymata_aio Version 2.33 Copyright (c) 2015-2018 Alan Yorinks All rights reserved.

Using COM Port:/dev/ttyACM0

Initializing Arduino - Please wait...
Arduino Firmware ID: 2.5 StandardFirmata.ino
Auto-discovery complete. Found 30 Digital Pins and 12 Analog Pins


Enter a PWM setting to test(0-180)95
Enter a PWM setting to test(0-180)90
Enter a PWM setting to test(0-180)85
...
</code></pre>
<p>Note the <strong>--arduino</strong> switch passed to the calibrate command. Further note that the arduino pin being
 calibrated is passed via the <strong>--channel</strong> parameter.</p>
<h3 id="using-the-arduino-actuator-part">Using the arduino actuator part</h3>
<p>The following snippet illustrates how to exercise the Arduino actuator in the drive() loop:</p>
<pre><code class="language-python">    #Drive train setup
    arduino_controller = ArduinoFirmata(
                                    servo_pin=cfg.STEERING_ARDUINO_PIN,
                                    esc_pin=cfg.THROTTLE_ARDUINO_PIN)

    steering = ArdPWMSteering(controller=arduino_controller,
                        left_pulse=cfg.STEERING_ARDUINO_LEFT_PWM,
                        right_pulse=cfg.STEERING_ARDUINO_RIGHT_PWM)

    throttle = ArdPWMThrottle(controller=arduino_controller,
                        max_pulse=cfg.THROTTLE_ARDUINO_FORWARD_PWM,
                        zero_pulse=cfg.THROTTLE_ARDUINO_STOPPED_PWM,
                        min_pulse=cfg.THROTTLE_ARDUINO_REVERSE_PWM)

    V.add(steering, inputs=['user/angle'])
    V.add(throttle, inputs=['user/throttle'])
</code></pre>
<p>Refer to templates/arduino_drive.py for more details.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../controllers/" class="btn btn-neutral float-right" title="Controllers">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../about/" class="btn btn-neutral" title="About"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/autorope/donkeydocs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../about/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../controllers/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
